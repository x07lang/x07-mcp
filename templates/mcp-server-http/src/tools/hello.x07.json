{"decls":[{"kind":"export","names":["tools.hello.call_tool_v1"]},{"body":["begin",["let","diag",["std.mcp.diag.code_invalid_args_v1"]],["let","detail",["bytes.lit","{}"]],["std.mcp.tool.result.err_v1",["bytes.view","diag"],["bytes.view","human_text_utf8"],["bytes.view","detail"]]],"kind":"defn","name":"tools.hello._err_invalid_args_v1","params":[{"name":"human_text_utf8","ty":"bytes"}],"result":"bytes"},{"body":["begin",["let","st",["std.parse.i32_status_le","b"]],["if",["if",[">=u",["bytes.len","st"],5],["=",["bytes.get_u8","st",0],1],0],["codec.read_u32_le","st",1],-1]],"kind":"defn","name":"tools.hello._parse_i32_or_neg1_v1","params":[{"name":"b","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["std.mcp.toolkit.toolctx.resources_notify_updated_v1","ctx_json",["bytes.lit","hello://greeting"]],["let","bumped_text",["bytes.lit","bumped"]],["std.mcp.tool.result.ok_text_v1",["bytes.view","bumped_text"]]],"kind":"defn","name":"tools.hello._tool_hello_bump_resource_v1","params":[{"name":"ctx_json","ty":"bytes_view"},{"name":"args_json","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","doc_b",["ext.json.data_model.parse","args_json"]],["let","doc",["bytes.view","doc_b"]],["if",["=",["ext.data_model.doc_is_err","doc"],1],["return",["tools.hello._err_invalid_args_v1",["bytes.lit","invalid arguments JSON"]]],0],["if",["!=",["ext.data_model.root_kind","doc"],5],["return",["tools.hello._err_invalid_args_v1",["bytes.lit","arguments must be an object"]]],0],["let","root",["ext.data_model.root_offset","doc"]],["let","k_text",["bytes.lit","text"]],["let","text_off",["ext.data_model.map_find","doc","root",["bytes.view","k_text"]]],["if",["if",["<","text_off",0],1,["!=",["ext.data_model.kind_at","doc","text_off"],3]],["return",["tools.hello._err_invalid_args_v1",["bytes.lit","missing text argument"]]],0],["let","text",["ext.data_model.string_get","doc","text_off"]],["std.mcp.tool.result.ok_text_v1",["bytes.view","text"]]],"kind":"defn","name":"tools.hello._tool_hello_echo_v1","params":[{"name":"args_json","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","steps",3],["let","doc_b",["ext.json.data_model.parse","args_json"]],["let","doc",["bytes.view","doc_b"]],["if",["=",["ext.data_model.doc_is_err","doc"],1],0,["begin",["if",["=",["ext.data_model.root_kind","doc"],5],["begin",["let","root",["ext.data_model.root_offset","doc"]],["let","k_steps",["bytes.lit","steps"]],["let","steps_off",["ext.data_model.map_find","doc","root",["bytes.view","k_steps"]]],["if",["if",["<","steps_off",0],1,["!=",["ext.data_model.kind_at","doc","steps_off"],2]],0,["begin",["let","raw",["ext.data_model.number_get","doc","steps_off"]],["let","v",["tools.hello._parse_i32_or_neg1_v1",["bytes.view","raw"]]],["if",[">","v",0],["set","steps","v"],0],0]],0],0],0]],["let","empty",["bytes.alloc",0]],["let","cancelled",["bytes.lit","cancelled"]],["for","i",0,"steps",["begin",["if",["=",["std.mcp.toolkit.toolctx.is_cancelled_v1","ctx_json"],1],["return",["std.mcp.tool.result.ok_text_v1",["bytes.view","cancelled"]]],0],["std.mcp.toolkit.toolctx.progress_emit_v1","ctx_json",["+","i",1],"steps",["bytes.view","empty"]],0]],["let","done_text",["bytes.lit","done"]],["std.mcp.tool.result.ok_text_v1",["bytes.view","done_text"]]],"kind":"defn","name":"tools.hello._tool_hello_work_v1","params":[{"name":"ctx_json","ty":"bytes_view"},{"name":"args_json","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","t_echo",["bytes.lit","hello.echo"]],["let","t_greet",["bytes.lit","hello.greet"]],["let","t_work",["bytes.lit","hello.work"]],["let","t_bump",["bytes.lit","hello.bump_resource"]],["if",["=",["bytes.eq","tool_name",["bytes.view","t_echo"]],1],["return",["tools.hello._tool_hello_echo_v1","args_json"]],0],["if",["=",["bytes.eq","tool_name",["bytes.view","t_greet"]],1],["return",["tools.hello._tool_hello_echo_v1","args_json"]],0],["if",["=",["bytes.eq","tool_name",["bytes.view","t_work"]],1],["return",["tools.hello._tool_hello_work_v1","ctx_json","args_json"]],0],["if",["=",["bytes.eq","tool_name",["bytes.view","t_bump"]],1],["return",["tools.hello._tool_hello_bump_resource_v1","ctx_json","args_json"]],0],["tools.hello._err_invalid_args_v1",["bytes.lit","unknown tool"]]],"kind":"defn","name":"tools.hello.call_tool_v1","params":[{"name":"tool_name","ty":"bytes_view"},{"name":"ctx_json","ty":"bytes_view"},{"name":"args_json","ty":"bytes_view"}],"result":"bytes"}],"imports":["ext.data_model","ext.json.data_model","std.mcp.diag","std.mcp.tool.result","std.mcp.toolkit.toolctx","std.parse"],"kind":"module","module_id":"tools.hello","schema_version":"x07.x07ast@0.5.0"}

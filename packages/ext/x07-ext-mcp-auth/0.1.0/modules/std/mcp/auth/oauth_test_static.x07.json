{"decls":[{"kind":"export","names":["std.mcp.auth.oauth_test_static.verify_status_v1"]},{"body":["begin",["let","_ignore","oauth_doc_json"],["let","n",["view.len","authorization_header"]],["if",["<=","n",7],["return",401],0],["let","prefix",["view.slice","authorization_header",0,7]],["let","want_prefix",["bytes.lit","Bearer "]],["if",["=",["view.eq","prefix",["bytes.view","want_prefix"]],0],["return",401],0],["let","token",["view.slice","authorization_header",7,["-","n",7]]],["let","token_ok",["bytes.lit","TOKEN_OK"]],["let","token_no_scope",["bytes.lit","TOKEN_NO_SCOPE"]],["if",["=",["view.eq","token",["bytes.view","token_ok"]],1],["begin",["if",["=",["view.len","required_scope_text"],0],["return",200],0],["let","default_scope",["bytes.lit","mcp:tools"]],["if",["=",["view.eq","required_scope_text",["bytes.view","default_scope"]],1],["return",200],["return",403]]],0],["if",["=",["view.eq","token",["bytes.view","token_no_scope"]],1],["begin",["if",["=",["view.len","required_scope_text"],0],["return",200],["return",403]]],0],401],"kind":"defn","name":"std.mcp.auth.oauth_test_static.verify_status_v1","params":[{"name":"oauth_doc_json","ty":"bytes_view"},{"name":"authorization_header","ty":"bytes_view"},{"name":"required_scope_text","ty":"bytes_view"}],"result":"i32"}],"imports":[],"kind":"module","module_id":"std.mcp.auth.oauth_test_static","schema_version":"x07.x07ast@0.5.0"}

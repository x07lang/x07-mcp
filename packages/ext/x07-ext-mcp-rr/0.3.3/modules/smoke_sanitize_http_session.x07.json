{"decls":[{"kind":"export","names":["smoke_sanitize_http_session.bearer_header_redacted","smoke_sanitize_http_session.cookie_headers_redacted","smoke_sanitize_http_session.new_token_survives_fails_closed","smoke_sanitize_http_session.proxy_authorization_redacted","smoke_sanitize_http_session.token_key_survives_fails_closed"]},{"body":["begin",["let","input_json",["std.fs.read",["bytes.lit","cases/bearer_header_redacted.input.json"]]],["let","expected",["std.fs.read",["bytes.lit","cases/bearer_header_redacted.expected.json"]]],["let","got",["std.mcp.rr.sanitize.sanitize_http_session_v1",["bytes.view","input_json"]]],["try",["std.test.assert_bytes_eq","got","expected",["std.test.code_assert_bytes_eq"]]],["std.test.pass"]],"kind":"defn","name":"smoke_sanitize_http_session.bearer_header_redacted","params":[],"result":"result_i32"},{"body":["begin",["let","input_json",["std.fs.read",["bytes.lit","cases/cookie_headers_redacted.input.json"]]],["let","expected",["std.fs.read",["bytes.lit","cases/cookie_headers_redacted.expected.json"]]],["let","got",["std.mcp.rr.sanitize.sanitize_http_session_v1",["bytes.view","input_json"]]],["try",["std.test.assert_bytes_eq","got","expected",["std.test.code_assert_bytes_eq"]]],["std.test.pass"]],"kind":"defn","name":"smoke_sanitize_http_session.cookie_headers_redacted","params":[],"result":"result_i32"},{"body":["begin",["let","input_json",["std.fs.read",["bytes.lit","cases/new_token_survives_fails_closed.input.json"]]],["let","got",["std.mcp.rr.sanitize.sanitize_http_session_v1",["bytes.view","input_json"]]],["try",["std.test.assert_i32_eq",["bytes.len",["bytes.view","got"]],0,["std.test.code_assert_i32_eq"]]],["std.test.pass"]],"kind":"defn","name":"smoke_sanitize_http_session.new_token_survives_fails_closed","params":[],"result":"result_i32"},{"body":["begin",["let","input_json",["std.fs.read",["bytes.lit","cases/proxy_authorization_redacted.input.json"]]],["let","expected",["std.fs.read",["bytes.lit","cases/proxy_authorization_redacted.expected.json"]]],["let","got",["std.mcp.rr.sanitize.sanitize_http_session_v1",["bytes.view","input_json"]]],["try",["std.test.assert_bytes_eq","got","expected",["std.test.code_assert_bytes_eq"]]],["std.test.pass"]],"kind":"defn","name":"smoke_sanitize_http_session.proxy_authorization_redacted","params":[],"result":"result_i32"},{"body":["begin",["let","input_json",["std.fs.read",["bytes.lit","cases/token_key_survives_fails_closed.input.json"]]],["let","got",["std.mcp.rr.sanitize.sanitize_http_session_v1",["bytes.view","input_json"]]],["try",["std.test.assert_i32_eq",["bytes.len",["bytes.view","got"]],0,["std.test.code_assert_i32_eq"]]],["std.test.pass"]],"kind":"defn","name":"smoke_sanitize_http_session.token_key_survives_fails_closed","params":[],"result":"result_i32"}],"imports":["std.fs","std.mcp.rr.sanitize","std.test"],"kind":"module","module_id":"smoke_sanitize_http_session","schema_version":"x07.x07ast@0.3.0"}

{"decls":[{"kind":"export","names":["std.mcp.auth.bearer_v1.build_www_authenticate_bearer_v1","std.mcp.auth.bearer_v1.parse_authorization_bearer_v1"]},{"body":["if",["if",[">=u","c",65],["<u","c",91],0],["+","c",32],"c"],"kind":"defn","name":"std.mcp.auth.bearer_v1._ascii_fold_u8_v1","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","an",["view.len","a"]],["let","bn",["view.len","b"]],["if",["<",["-","an","a_off"],"bn"],["return",0],0],["for","i",0,"bn",["begin",["let","ac",["std.mcp.auth.bearer_v1._ascii_fold_u8_v1",["view.get_u8","a",["+","a_off","i"]]]],["let","bc",["std.mcp.auth.bearer_v1._ascii_fold_u8_v1",["view.get_u8","b","i"]]],["if",["!=","ac","bc"],["return",0],0],0]],1],"kind":"defn","name":"std.mcp.auth.bearer_v1._eq_ci_v1","params":[{"name":"a","ty":"bytes_view"},{"name":"a_off","ty":"i32"},{"name":"b","ty":"bytes_view"}],"result":"i32"},{"body":["if",["=","c",32],1,["if",["=","c",9],1,0]],"kind":"defn","name":"std.mcp.auth.bearer_v1._is_ws_v1","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","text"]],["let","i","start"],["for","_",0,"n",["begin",["if",[">=","i","n"],["return","i"],0],["if",["=",["std.mcp.auth.bearer_v1._is_ws_v1",["view.get_u8","text","i"]],1],["set","i",["+","i",1]],["return","i"]],0]],"i"],"kind":"defn","name":"std.mcp.auth.bearer_v1._skip_ws_v1","params":[{"name":"text","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","e","end"],["let","n",["view.len","text"]],["if",[">","e","n"],["set","e","n"],0],["for","_",0,"n",["begin",["if",["<=","e","start"],["return","start"],0],["if",["=",["std.mcp.auth.bearer_v1._is_ws_v1",["view.get_u8","text",["-","e",1]]],1],["set","e",["-","e",1]],["return","e"]],0]],"e"],"kind":"defn","name":"std.mcp.auth.bearer_v1._trim_end_ws_v1","params":[{"name":"text","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"},{"body":["begin",["let","out",["vec_u8.with_capacity",384]],["let","pfx",["bytes.lit","Bearer resource_metadata=\""]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","pfx"]]],["set","out",["vec_u8.extend_bytes","out","resource_metadata_url"]],["set","out",["vec_u8.push","out",34]],["if",[">",["view.len","scope_text"],0],["begin",["let","p_scope",["bytes.lit",", scope=\""]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","p_scope"]]],["set","out",["vec_u8.extend_bytes","out","scope_text"]],["set","out",["vec_u8.push","out",34]],0],0],["if",["=","err_kind",1],["begin",["let","p_err",["bytes.lit",", error=\"invalid_request\""]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","p_err"]]],0],0],["if",["=","err_kind",2],["begin",["let","p_err",["bytes.lit",", error=\"invalid_token\""]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","p_err"]]],0],0],["if",["=","err_kind",3],["begin",["let","p_err",["bytes.lit",", error=\"insufficient_scope\""]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","p_err"]]],0],0],["vec_u8.into_bytes","out"]],"kind":"defn","name":"std.mcp.auth.bearer_v1.build_www_authenticate_bearer_v1","params":[{"name":"resource_metadata_url","ty":"bytes_view"},{"name":"scope_text","ty":"bytes_view"},{"name":"err_kind","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","header_value"]],["let","i0",["std.mcp.auth.bearer_v1._skip_ws_v1","header_value",0]],["let","scheme",["bytes.lit","bearer"]],["let","scheme_len",["view.len",["bytes.view","scheme"]]],["if",["<",["-","n","i0"],"scheme_len"],["return",["bytes.alloc",0]],0],["if",["=",["std.mcp.auth.bearer_v1._eq_ci_v1","header_value","i0",["bytes.view","scheme"]],0],["return",["bytes.alloc",0]],0],["let","i1",["+","i0","scheme_len"]],["if",[">=","i1","n"],["return",["bytes.alloc",0]],0],["if",["=",["std.mcp.auth.bearer_v1._is_ws_v1",["view.get_u8","header_value","i1"]],0],["return",["bytes.alloc",0]],0],["let","i2",["std.mcp.auth.bearer_v1._skip_ws_v1","header_value","i1"]],["if",[">=","i2","n"],["return",["bytes.alloc",0]],0],["let","end",["std.mcp.auth.bearer_v1._trim_end_ws_v1","header_value","i2","n"]],["let","len",["-","end","i2"]],["if",["<=","len",0],["return",["bytes.alloc",0]],0],["view.to_bytes",["view.slice","header_value","i2","len"]]],"kind":"defn","name":"std.mcp.auth.bearer_v1.parse_authorization_bearer_v1","params":[{"name":"header_value","ty":"bytes_view"}],"result":"bytes"}],"imports":["std.bytes"],"kind":"module","module_id":"std.mcp.auth.bearer_v1","schema_version":"x07.x07ast@0.5.0"}

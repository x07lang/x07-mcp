{"decls":[{"kind":"export","names":["std.mcp.toolkit.toolctx.is_cancelled_v1","std.mcp.toolkit.toolctx.progress_emit_v1","std.mcp.toolkit.toolctx.resources_notify_updated_v1","std.mcp.toolkit.toolctx.task_set_status_message_v1"]},{"body":["begin",["let","k_progress_token",["bytes.lit","x07McpProgressToken"]],["let","doc_b",["ext.json.data_model.parse","ctx_json"]],["let","doc",["bytes.view","doc_b"]],["if",["=",["ext.data_model.doc_is_err","doc"],1],["return",["bytes.alloc",0]],0],["if",["!=",["ext.data_model.root_kind","doc"],5],["return",["bytes.alloc",0]],0],["let","root",["ext.data_model.root_offset","doc"]],["let","off",["ext.data_model.map_find","doc","root",["bytes.view","k_progress_token"]]],["if",["<","off",0],["return",["bytes.alloc",0]],0],["let","end",["ext.data_model.skip_value","doc","off"]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["let","val_dm",["view.to_bytes",["view.slice","doc","off",["-","end","off"]]]],["std.mcp.util.json.json_from_value_v1",["bytes.view","val_dm"]]],"kind":"defn","name":"std.mcp.toolkit.toolctx._progress_token_json_from_ctx_v1","params":[{"name":"ctx_json","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","nl",["bytes.alloc",1]],["set","nl",["bytes.set_u8","nl",0,10]],["let","line",["std.bytes.concat","json",["bytes.view","nl"]]],["let","caps",["std.os.stdio.spec.caps_default_v1"]],["let","w",["std.os.stdio.write_stdout_v1","line","caps"]],["if",["!=",["result_i32.err_code","w"],0],["return",0],0],["let","f",["std.os.stdio.flush_stdout_v1"]],["if",["!=",["result_i32.err_code","f"],0],0,0],1],"kind":"defn","name":"std.mcp.toolkit.toolctx._write_jsonl_stdout_v1","params":[{"name":"json","ty":"bytes_view"}],"result":"i32"},{"body":["begin",0],"kind":"defn","name":"std.mcp.toolkit.toolctx.is_cancelled_v1","params":[{"name":"ctx_json","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","token_json",["std.mcp.toolkit.toolctx._progress_token_json_from_ctx_v1","ctx_json"]],["if",["=",["std.bytes.len","token_json"],0],["return",0],0],["let","notif",["std.mcp.notifications.progress_v1",["bytes.view","token_json"],"progress_i32","total_i32","message_utf8"]],["std.mcp.toolkit.toolctx._write_jsonl_stdout_v1",["bytes.view","notif"]]],"kind":"defn","name":"std.mcp.toolkit.toolctx.progress_emit_v1","params":[{"name":"ctx_json","ty":"bytes_view"},{"name":"progress_i32","ty":"i32"},{"name":"total_i32","ty":"i32"},{"name":"message_utf8","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","notif",["std.mcp.notifications.resources_updated_v1","uri_utf8"]],["std.mcp.toolkit.toolctx._write_jsonl_stdout_v1",["bytes.view","notif"]]],"kind":"defn","name":"std.mcp.toolkit.toolctx.resources_notify_updated_v1","params":[{"name":"ctx_json","ty":"bytes_view"},{"name":"uri_utf8","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","_","ctx_json"],["let","msg_val",["ext.data_model.value_string","message_utf8"]],["let","msg_json",["std.mcp.util.json.json_from_value_v1",["bytes.view","msg_val"]]],["let","p0",["bytes.lit","{\"jsonrpc\":\"2.0\",\"method\":\"x07.mcp/internal/task/set_status_message\",\"params\":{\"message\":"]],["let","p1",["bytes.lit","}}"]],["let","t0",["std.bytes.concat",["bytes.view","p0"],["bytes.view","msg_json"]]],["let","line",["std.bytes.concat",["bytes.view","t0"],["bytes.view","p1"]]],["std.mcp.toolkit.toolctx._write_jsonl_stdout_v1",["bytes.view","line"]]],"kind":"defn","name":"std.mcp.toolkit.toolctx.task_set_status_message_v1","params":[{"name":"ctx_json","ty":"bytes_view"},{"name":"message_utf8","ty":"bytes_view"}],"result":"i32"}],"imports":["ext.data_model","ext.json.data_model","std.bytes","std.mcp.notifications","std.mcp.util.json","std.os.stdio","std.os.stdio.spec"],"kind":"module","module_id":"std.mcp.toolkit.toolctx","schema_version":"x07.x07ast@0.5.0"}

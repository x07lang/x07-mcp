{"decls":[{"kind":"export","names":["std.mcp.toolkit.derive_hooks.validate_tool_args_v1"]},{"body":["begin",["let","k_path",["bytes.lit","jsonPointer"]],["let","k_keyword",["bytes.lit","keyword"]],["let","k_message",["bytes.lit","message"]],["let","v_path",["ext.data_model.value_string","json_pointer"]],["let","v_keyword",["ext.data_model.value_string","keyword"]],["let","v_message",["ext.data_model.value_string","message"]],["let","entries",["vec_u8.with_capacity",256]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",3]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_path"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_path"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_path"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_path"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_keyword"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_keyword"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_keyword"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_keyword"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_message"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_message"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_message"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_message"]]],["let","entries_b",["vec_u8.into_bytes","entries"]],["let","map_val",["ext.data_model.value_map_from_entries",["bytes.view","entries_b"]]],["if",["=",["std.bytes.len","map_val"],0],["return",["bytes.alloc",0]],0],["let","elems",["vec_u8.with_capacity",128]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",1]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","map_val"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","map_val"]]],["let","elems_b",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","elems_b"]]],["if",["=",["std.bytes.len","seq_val"],0],["return",["bytes.alloc",0]],0],["std.mcp.util.json.json_from_value_v1",["bytes.view","seq_val"]]],"kind":"defn","name":"std.mcp.toolkit.derive_hooks._one_error_json_v1","params":[{"name":"json_pointer","ty":"bytes_view"},{"name":"keyword","ty":"bytes_view"},{"name":"message","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","schema_res",["std.mcp.toolkit.tools_file.tool_input_schema_json_v1","tools_registry_json","tool_name"]],["if",["!=",["result_bytes.err_code","schema_res"],0],["return","schema_res"],0],["let","schema_json",["result_bytes.unwrap_or","schema_res",["bytes.alloc",0]]],["let","subset_ok",["std.mcp.toolkit.schema_subset.supports_v1",["bytes.view","schema_json"]]],["if",["=","subset_ok",1],["begin",["let","errs",["std.mcp.toolkit.schema_subset.validate_v1",["bytes.view","schema_json"],"args_json"]],["return",["result_bytes.ok","errs"]]],0],["let","compiled_b",["ext.jsonschema.compile_v1",["bytes.view","schema_json"]]],["let","compiled",["bytes.view","compiled_b"]],["if",["=",["ext.jsonschema.is_err_v1","compiled"],1],["begin",["let","empty",["bytes.alloc",0]],["let","k_schema",["bytes.lit","schema"]],["let","msg_b",["ext.jsonschema.err_msg_v1","compiled"]],["let","msg",["bytes.view","msg_b"]],["let","errors_json",["std.mcp.toolkit.derive_hooks._one_error_json_v1",["bytes.view","empty"],["bytes.view","k_schema"],"msg"]],["return",["result_bytes.ok","errors_json"]]],0],["let","val_b",["ext.jsonschema.validate_v1","compiled","args_json"]],["let","val",["bytes.view","val_b"]],["if",["=",["ext.jsonschema.is_err_v1","val"],1],["return",["result_bytes.ok",["ext.jsonschema.errors_json_v1","val"]]],0],["result_bytes.ok",["bytes.alloc",0]]],"kind":"defn","name":"std.mcp.toolkit.derive_hooks.validate_tool_args_v1","params":[{"name":"tools_registry_json","ty":"bytes_view"},{"name":"tool_name","ty":"bytes_view"},{"name":"args_json","ty":"bytes_view"}],"result":"result_bytes"}],"imports":["ext.data_model","ext.jsonschema","std.bytes","std.mcp.toolkit.schema_subset","std.mcp.toolkit.tools_file","std.mcp.util.json"],"kind":"module","module_id":"std.mcp.toolkit.derive_hooks","schema_version":"x07.x07ast@0.5.0"}

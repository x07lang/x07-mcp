{"decls":[{"kind":"export","names":["std.mcp.toolkit.audit.tag_v1"]},{"body":["begin",["let","_",["view.to_bytes","ctx_json"]],["let","klen",["view.len","key_str"]],["let","vlen",["view.len","value_str"]],["if",["if",["<=","klen",0],1,[">","klen",64]],["return",["result_i32.err",1]],0],["if",[">","vlen",256],["return",["result_i32.err",1]],0],["let","lit_prefix",["bytes.lit","{\"jsonrpc\":\"2.0\",\"method\":\"x07.mcp/internal/oob/audit_tag\",\"params\":{\"key\":\""]],["let","lit_mid",["bytes.lit","\",\"value\":\""]],["let","lit_end",["bytes.lit","\"}}"]],["let","cap",["+",80,["+","klen","vlen"]]],["let","buf",["vec_u8.with_capacity","cap"]],["set","buf",["vec_u8.extend_bytes","buf",["bytes.view","lit_prefix"]]],["set","buf",["vec_u8.extend_bytes","buf","key_str"]],["set","buf",["vec_u8.extend_bytes","buf",["bytes.view","lit_mid"]]],["set","buf",["vec_u8.extend_bytes","buf","value_str"]],["set","buf",["vec_u8.extend_bytes","buf",["bytes.view","lit_end"]]],["let","json",["vec_u8.into_bytes","buf"]],["if",["=",["bytes.len","json"],0],["return",["result_i32.err",2]],0],["let","ok",["std.mcp.toolkit.oob_chan.write_jsonl_v1","ctx_json",["bytes.view","json"]]],["if",["=","ok",1],["result_i32.ok",0],["result_i32.err",3]]],"kind":"defn","name":"std.mcp.toolkit.audit.tag_v1","params":[{"name":"ctx_json","ty":"bytes_view"},{"name":"key_str","ty":"bytes_view"},{"name":"value_str","ty":"bytes_view"}],"result":"result_i32"}],"imports":["ext.data_model","std.bytes","std.codec","std.mcp.toolkit.oob_chan","std.mcp.util.json"],"kind":"module","module_id":"std.mcp.toolkit.audit","schema_version":"x07.x07ast@0.5.0"}

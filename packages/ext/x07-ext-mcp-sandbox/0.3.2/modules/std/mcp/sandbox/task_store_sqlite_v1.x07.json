{"decls":[{"kind":"export","names":["std.mcp.sandbox.task_store_sqlite_v1.cursor_decode_v1","std.mcp.sandbox.task_store_sqlite_v1.cursor_encode_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_args_json_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_json_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_progress_token_json_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_request_id_json_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_result_json_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_status_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_ticks_done_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_tool_name_v1","std.mcp.sandbox.task_store_sqlite_v1.get_task_value_v1","std.mcp.sandbox.task_store_sqlite_v1.list_tasks_json_v1","std.mcp.sandbox.task_store_sqlite_v1.new_v1","std.mcp.sandbox.task_store_sqlite_v1.put_tool_task_new_v1","std.mcp.sandbox.task_store_sqlite_v1.set_task_cancelled_v1","std.mcp.sandbox.task_store_sqlite_v1.set_task_completed_v1","std.mcp.sandbox.task_store_sqlite_v1.set_task_failed_v1","std.mcp.sandbox.task_store_sqlite_v1.set_task_failed_with_result_v1","std.mcp.sandbox.task_store_sqlite_v1.set_task_status_message_v1","std.mcp.sandbox.task_store_sqlite_v1.set_task_working_step_v1"]},{"body":["begin",["let","caps",["std.db.sqlite.caps_default_v1"]],["let","_",["std.db.sqlite.close_v1","conn",["bytes.view","caps"]]],0],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","params":[{"name":"conn","ty":"i32"}],"result":"i32"},{"body":["begin",["let","caps",["std.db.sqlite.caps_default_v1"]],["let","open_flags",["std.db.sqlite.spec.open_flag_create_v1"]],["let","resp",["std.db.sqlite.open_v1",["view.to_bytes","db_path"],"open_flags",["bytes.view","caps"]]],["if",["=",["std.db.spec.resp_is_ok_v1","resp"],1],["result_i32.ok",["codec.read_u32_le",["std.db.spec.resp_ok_payload_view_v1","resp"],0]],["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1","params":[{"name":"db_path","ty":"bytes_view"}],"result":"result_i32"},{"body":7403,"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._err_db_v1","params":[],"result":"i32"},{"body":7402,"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._err_invalid_cursor_v1","params":[],"result":"i32"},{"body":7401,"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._err_not_found_v1","params":[],"result":"i32"},{"body":["begin",["let","caps",["std.db.sqlite.caps_default_v1"]],["let","flags",["std.db.sqlite.spec.flags_none_v1"]],["let","resp",["std.db.sqlite.exec_v1","conn","sql",["std.db.params.empty_v1"],"flags",["bytes.view","caps"]]],["if",["=",["std.db.spec.resp_is_ok_v1","resp"],1],["result_i32.ok",0],["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._exec0_v1","params":[{"name":"conn","ty":"i32"},{"name":"sql","ty":"bytes"}],"result":"result_i32"},{"body":["begin",["let","caps",["std.db.sqlite.caps_default_v1"]],["let","flags",["std.db.sqlite.spec.flags_none_v1"]],["let","resp",["std.db.sqlite.exec_v1","conn","sql","params_doc","flags",["bytes.view","caps"]]],["if",["=",["std.db.spec.resp_is_ok_v1","resp"],1],["result_i32.ok",0],["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._exec_v1","params":[{"name":"conn","ty":"i32"},{"name":"sql","ty":"bytes"},{"name":"params_doc","ty":"bytes"}],"result":"result_i32"},{"body":["begin",["let","now_iso",["ext.time.os.now_rfc3339_utc_v1"]],["let","now_unix",["std.mcp.sandbox.task_store_sqlite_v1._unix_s_or_0_v1",["bytes.view","now_iso"]]],["let","sql",["bytes.lit","DELETE FROM mcp_tasks WHERE auth_context_id = ?1 AND (created_unix_s + (ttl_ms / 1000)) <= ?2;"]],["let","p1",["ext.data_model.value_string","auth_context_id"]],["let","_x07_tmp_borrow_decls_8_body_5_2_1",["std.fmt.s32_to_dec","now_unix"]],["let","p2",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_8_body_5_2_1"]]],["let","elems",["vec_u8.with_capacity",64]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",2]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p2"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","_",["std.mcp.sandbox.task_store_sqlite_v1._exec_v1","conn","sql","params_doc"]],0],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._gc_v1","params":[{"name":"conn","ty":"i32"},{"name":"auth_context_id","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1","store"],1],0,["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_not_found_v1"]]]],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1","store"]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",["result_bytes.err",["result_i32.err_code","conn_res"]]],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","sql_pref",["bytes.lit","SELECT "]],["let","sql_mid",["bytes.lit"," FROM mcp_tasks WHERE auth_context_id = ?1 AND task_id = ?2 LIMIT 1;"]],["let","tmp",["std.bytes.concat",["bytes.view","sql_pref"],["bytes.view","col"]]],["let","sql",["std.bytes.concat",["bytes.view","tmp"],["bytes.view","sql_mid"]]],["let","p1",["ext.data_model.value_string","auth_context_id"]],["let","p2",["ext.data_model.value_string","task_id"]],["let","elems",["vec_u8.with_capacity",96]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",2]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p2"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","doc_res",["std.mcp.sandbox.task_store_sqlite_v1._query_doc_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["if",["!=",["result_bytes.err_code","doc_res"],0],["return","doc_res"],0],["let","doc",["result_bytes.unwrap_or","doc_res",["bytes.alloc",0]]],["let","cell",["std.mcp.sandbox.task_store_sqlite_v1._rows_doc_first_scalar_v1",["bytes.view","doc"]]],["if",["=",["std.bytes.len","cell"],0],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_not_found_v1"]]],0],["let","cellv",["bytes.view","cell"]],["if",["!=",["ext.data_model.kind_at","cellv",0],3],["return",["result_bytes.ok",["bytes.alloc",0]]],0],["result_bytes.ok",["ext.data_model.string_get","cellv",0]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._get_text_col_or_empty_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"col","ty":"bytes"}],"result":"result_bytes"},{"body":["begin",["let","caps",["std.db.sqlite.caps_default_v1"]],["let","flags",["std.db.sqlite.spec.flags_none_v1"]],["let","resp",["std.db.sqlite.query_v1","conn","sql","params_doc","flags",["bytes.view","caps"]]],["if",["=",["std.db.spec.resp_is_ok_v1","resp"],1],["begin",["let","doc",["std.db.spec.resp_ok_payload_v1","resp"]],["result_bytes.ok","doc"]],["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._query_doc_v1","params":[{"name":"conn","ty":"i32"},{"name":"sql","ty":"bytes"},{"name":"params_doc","ty":"bytes"}],"result":"result_bytes"},{"body":["begin",["if",["=",["ext.data_model.doc_is_err","rows_doc"],1],["return",["bytes.alloc",0]],0],["if",["!=",["ext.data_model.root_kind","rows_doc"],5],["return",["bytes.alloc",0]],0],["let","root",["ext.data_model.root_offset","rows_doc"]],["let","k_rows",["bytes.lit","rows"]],["let","rows_off",["ext.data_model.map_find","rows_doc","root",["bytes.view","k_rows"]]],["if",["<","rows_off",0],["return",["bytes.alloc",0]],0],["if",["!=",["ext.data_model.kind_at","rows_doc","rows_off"],4],["return",["bytes.alloc",0]],0],["if",["<",["ext.data_model.seq_len","rows_doc","rows_off"],1],["return",["bytes.alloc",0]],0],["let","row0",["ext.data_model.seq_get","rows_doc","rows_off",0]],["if",["<","row0",0],["return",["bytes.alloc",0]],0],["if",["!=",["ext.data_model.kind_at","rows_doc","row0"],4],["return",["bytes.alloc",0]],0],["if",["<",["ext.data_model.seq_len","rows_doc","row0"],1],["return",["bytes.alloc",0]],0],["let","cell0",["ext.data_model.seq_get","rows_doc","row0",0]],["if",["<","cell0",0],["return",["bytes.alloc",0]],0],["let","end",["ext.data_model.skip_value","rows_doc","cell0"]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["view.to_bytes",["view.slice","rows_doc","cell0",["-","end","cell0"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._rows_doc_first_scalar_v1","params":[{"name":"rows_doc","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1",["bytes.view","store"]],1],0,["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1",["bytes.view","store"]]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",["result_bytes.err",["result_i32.err_code","conn_res"]]],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","last_unix",["std.mcp.sandbox.task_store_sqlite_v1._unix_s_or_0_v1","last_updated_at"]],["let","sql",["bytes.lit","UPDATE mcp_tasks SET status_code = ?1, status_message = ?2, last_updated_at = ?3, last_unix_s = ?4, result_json = ?5 WHERE auth_context_id = ?6 AND task_id = ?7 AND (status_code = 0 OR status_code = 1);"]],["let","_x07_tmp_borrow_decls_12_body_8_2_1",["std.fmt.s32_to_dec","status_code"]],["let","v1",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_12_body_8_2_1"]]],["let","v2",["ext.data_model.value_string","status_message"]],["let","v3",["ext.data_model.value_string","last_updated_at"]],["let","_x07_tmp_borrow_decls_12_body_11_2_1",["std.fmt.s32_to_dec","last_unix"]],["let","v4",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_12_body_11_2_1"]]],["let","v5",["ext.data_model.value_string","result_json"]],["let","v6",["ext.data_model.value_string","auth_context_id"]],["let","v7",["ext.data_model.value_string","task_id"]],["let","elems",["vec_u8.with_capacity",256]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",7]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v2"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v3"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v3"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v4"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v4"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v5"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v5"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v6"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v6"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v7"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v7"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","res",["std.mcp.sandbox.task_store_sqlite_v1._exec_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["if",["=",["result_i32.err_code","res"],0],["result_bytes.ok","store"],["result_bytes.err",["result_i32.err_code","res"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._set_terminal_v1","params":[{"name":"store","ty":"bytes"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"status_code","ty":"i32"},{"name":"status_message","ty":"bytes_view"},{"name":"result_json","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["if",["=","status_code",0],["return",["bytes.lit","working"]],0],["if",["=","status_code",1],["return",["bytes.lit","input_required"]],0],["if",["=","status_code",2],["return",["bytes.lit","completed"]],0],["if",["=","status_code",3],["return",["bytes.lit","failed"]],0],["if",["=","status_code",4],["return",["bytes.lit","cancelled"]],0],["bytes.lit","failed"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._status_text_v1","params":[{"name":"status_code","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1","store"],1],["codec.read_u32_le","store",4],0]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._store_max_tasks_v1","params":[{"name":"store","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["<",["view.len","store"],12],["return",0],0],["if",["!=",["codec.read_u32_le","store",0],1],["return",0],0],["let","path_len",["codec.read_u32_le","store",8]],["if",["if",["<","path_len",0],1,["<u",["view.len","store"],["+",12,"path_len"]]],["return",0],0],1],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1","params":[{"name":"store","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1","store"],1],0,["return",["bytes.alloc",0]]],["let","path_len",["codec.read_u32_le","store",8]],["view.to_bytes",["view.slice","store",12,"path_len"]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._store_path_v1","params":[{"name":"store","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","status_text",["std.mcp.sandbox.task_store_sqlite_v1._status_text_v1","status_code"]],["let","k_taskId",["bytes.lit","taskId"]],["let","k_status",["bytes.lit","status"]],["let","k_statusMessage",["bytes.lit","statusMessage"]],["let","k_createdAt",["bytes.lit","createdAt"]],["let","k_lastUpdatedAt",["bytes.lit","lastUpdatedAt"]],["let","k_ttl",["bytes.lit","ttl"]],["let","k_poll",["bytes.lit","pollInterval"]],["let","v_taskId",["ext.data_model.value_string","task_id"]],["let","v_status",["ext.data_model.value_string",["bytes.view","status_text"]]],["let","v_created",["ext.data_model.value_string","created_at"]],["let","v_last",["ext.data_model.value_string","last_updated_at"]],["let","_x07_tmp_borrow_decls_17_body_13_2_1",["std.fmt.s32_to_dec","ttl_ms"]],["let","v_ttl",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_17_body_13_2_1"]]],["let","_x07_tmp_borrow_decls_17_body_14_2_1",["std.fmt.s32_to_dec","poll_ms"]],["let","v_poll",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_17_body_14_2_1"]]],["let","has_sm",["if",[">",["view.len","status_message"],0],1,0]],["let","entries",["vec_u8.with_capacity",256]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["+",6,"has_sm"]]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_taskId"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_taskId"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_taskId"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_taskId"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_status"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_status"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_status"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_status"]]],["if",["=","has_sm",1],["begin",["let","v_sm",["ext.data_model.value_string","status_message"]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_statusMessage"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_statusMessage"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_sm"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_sm"]]],0],0],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_createdAt"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_createdAt"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_created"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_created"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_lastUpdatedAt"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_lastUpdatedAt"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_last"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_last"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_ttl"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_ttl"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_ttl"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_ttl"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_poll"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_poll"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_poll"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_poll"]]],["let","eb",["vec_u8.into_bytes","entries"]],["let","val",["ext.data_model.value_map_from_entries",["bytes.view","eb"]]],"val"],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._task_val_v1","params":[{"name":"task_id","ty":"bytes_view"},{"name":"status_code","ty":"i32"},{"name":"status_message","ty":"bytes_view"},{"name":"created_at","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"ttl_ms","ty":"i32"},{"name":"poll_ms","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","doc",["ext.time.rfc3339.parse_v1","ts"]],["let","docv",["bytes.view","doc"]],["if",["=",["ext.time.rfc3339.is_err","docv"],1],0,["ext.time.rfc3339.unix_s_u32","docv"]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1._unix_s_or_0_v1","params":[{"name":"ts","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","dec_doc",["ext.base64.base64_decode","cursor_b64"]],["let","decv",["bytes.view","dec_doc"]],["if",["=",["ext.base64.base64_is_err","decv"],1],["return",["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_invalid_cursor_v1"]]],0],["let","raw",["ext.base64.base64_get_bytes","decv"]],["let","rv",["bytes.view","raw"]],["let","n",["view.len","rv"]],["if",["<","n",8],["return",["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_invalid_cursor_v1"]]],0],["let","auth_len",["codec.read_u32_le","rv",0]],["if",["if",["<","auth_len",0],1,[">=u",["+","auth_len",8],["+","n",1]]],["return",["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_invalid_cursor_v1"]]],0],["if",["=","auth_len",["view.len","auth_context_id"]],0,["return",["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_invalid_cursor_v1"]]]],["if",["=",["view.cmp_range","rv",4,"auth_len","auth_context_id",0,"auth_len"],0],0,["return",["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_invalid_cursor_v1"]]]],["let","off",["codec.read_u32_le","rv",["+","auth_len",4]]],["result_i32.ok","off"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.cursor_decode_v1","params":[{"name":"auth_context_id","ty":"bytes_view"},{"name":"cursor_b64","ty":"bytes_view"}],"result":"result_i32"},{"body":["begin",["let","off2",["if",["<","offset",0],0,"offset"]],["let","buf",["vec_u8.with_capacity",["+",["view.len","auth_context_id"],12]]],["set","buf",["vec_u8.extend_bytes","buf",["codec.write_u32_le",["view.len","auth_context_id"]]]],["set","buf",["vec_u8.extend_bytes","buf","auth_context_id"]],["set","buf",["vec_u8.extend_bytes","buf",["codec.write_u32_le","off2"]]],["let","raw",["vec_u8.into_bytes","buf"]],["ext.base64.base64_encode",["bytes.view","raw"]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.cursor_encode_v1","params":[{"name":"auth_context_id","ty":"bytes_view"},{"name":"offset","ty":"i32"}],"result":"bytes"},{"body":["std.mcp.sandbox.task_store_sqlite_v1._get_text_col_or_empty_v1","store","auth_context_id","task_id",["bytes.lit","args_json"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_args_json_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["let","val_res",["std.mcp.sandbox.task_store_sqlite_v1.get_task_value_v1","store","auth_context_id","task_id"]],["if",["!=",["result_bytes.err_code","val_res"],0],["return","val_res"],0],["let","val",["result_bytes.unwrap_or","val_res",["bytes.alloc",0]]],["let","json",["std.mcp.util.json.json_from_value_v1",["bytes.view","val"]]],["result_bytes.ok","json"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_json_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"result_bytes"},{"body":["std.mcp.sandbox.task_store_sqlite_v1._get_text_col_or_empty_v1","store","auth_context_id","task_id",["bytes.lit","progress_token_json"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_progress_token_json_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"result_bytes"},{"body":["std.mcp.sandbox.task_store_sqlite_v1._get_text_col_or_empty_v1","store","auth_context_id","task_id",["bytes.lit","request_id_json"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_request_id_json_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"result_bytes"},{"body":["std.mcp.sandbox.task_store_sqlite_v1._get_text_col_or_empty_v1","store","auth_context_id","task_id",["bytes.lit","result_json"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_result_json_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1","store"],1],0,["return",-1]],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1","store"]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",-1],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","sql",["bytes.lit","SELECT status_code FROM mcp_tasks WHERE auth_context_id = ?1 AND task_id = ?2 LIMIT 1;"]],["let","p1",["ext.data_model.value_string","auth_context_id"]],["let","p2",["ext.data_model.value_string","task_id"]],["let","elems",["vec_u8.with_capacity",96]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",2]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p2"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","doc_res",["std.mcp.sandbox.task_store_sqlite_v1._query_doc_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["if",["!=",["result_bytes.err_code","doc_res"],0],["return",-1],0],["let","doc",["result_bytes.unwrap_or","doc_res",["bytes.alloc",0]]],["let","cell",["std.mcp.sandbox.task_store_sqlite_v1._rows_doc_first_scalar_v1",["bytes.view","doc"]]],["if",["=",["std.bytes.len","cell"],0],["return",-1],0],["let","cellv",["bytes.view","cell"]],["if",["!=",["ext.data_model.kind_at","cellv",0],2],["return",-1],0],["let","num_b",["ext.data_model.number_get","cellv",0]],["let","st",["std.parse.i32_status_le",["bytes.view","num_b"]]],["if",["if",[">=u",["std.bytes.len","st"],5],["=",["bytes.get_u8","st",0],1],0],["codec.read_u32_le","st",1],-1]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_status_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1","store"],1],0,["return",["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_not_found_v1"]]]],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1","store"]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",["result_i32.err",["result_i32.err_code","conn_res"]]],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","sql",["bytes.lit","SELECT ticks_done FROM mcp_tasks WHERE auth_context_id = ?1 AND task_id = ?2 LIMIT 1;"]],["let","p1",["ext.data_model.value_string","auth_context_id"]],["let","p2",["ext.data_model.value_string","task_id"]],["let","elems",["vec_u8.with_capacity",96]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",2]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p2"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","doc_res",["std.mcp.sandbox.task_store_sqlite_v1._query_doc_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["if",["!=",["result_bytes.err_code","doc_res"],0],["return",["result_i32.err",["result_bytes.err_code","doc_res"]]],0],["let","doc",["result_bytes.unwrap_or","doc_res",["bytes.alloc",0]]],["let","cell",["std.mcp.sandbox.task_store_sqlite_v1._rows_doc_first_scalar_v1",["bytes.view","doc"]]],["if",["=",["std.bytes.len","cell"],0],["return",["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_not_found_v1"]]],0],["let","cellv",["bytes.view","cell"]],["if",["!=",["ext.data_model.kind_at","cellv",0],2],["return",["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["let","num_b",["ext.data_model.number_get","cellv",0]],["let","st",["std.parse.i32_status_le",["bytes.view","num_b"]]],["if",["if",[">=u",["std.bytes.len","st"],5],["=",["bytes.get_u8","st",0],1],0],["result_i32.ok",["codec.read_u32_le","st",1]],["result_i32.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_ticks_done_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"result_i32"},{"body":["std.mcp.sandbox.task_store_sqlite_v1._get_text_col_or_empty_v1","store","auth_context_id","task_id",["bytes.lit","tool_name"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_tool_name_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1","store"],1],0,["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_not_found_v1"]]]],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1","store"]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",["result_bytes.err",["result_i32.err_code","conn_res"]]],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","sql",["bytes.lit","SELECT status_code, status_message, created_at, last_updated_at, ttl_ms, poll_ms FROM mcp_tasks WHERE auth_context_id = ?1 AND task_id = ?2 LIMIT 1;"]],["let","p1",["ext.data_model.value_string","auth_context_id"]],["let","p2",["ext.data_model.value_string","task_id"]],["let","elems",["vec_u8.with_capacity",96]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",2]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p2"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","doc_res",["std.mcp.sandbox.task_store_sqlite_v1._query_doc_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["if",["!=",["result_bytes.err_code","doc_res"],0],["return","doc_res"],0],["let","rows_doc",["result_bytes.unwrap_or","doc_res",["bytes.alloc",0]]],["let","rows_val",["std.db.dm.rows_doc_rows_value_v1",["bytes.view","rows_doc"]]],["let","rv",["bytes.view","rows_val"]],["if",["=",["std.bytes.len","rv"],0],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_not_found_v1"]]],0],["if",["!=",["ext.data_model.kind_at","rv",0],4],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["let","rows_off",0],["if",["<",["ext.data_model.seq_len","rv","rows_off"],1],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_not_found_v1"]]],0],["let","row0",["ext.data_model.seq_get","rv","rows_off",0]],["if",["<","row0",0],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["if",["!=",["ext.data_model.kind_at","rv","row0"],4],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["if",["<",["ext.data_model.seq_len","rv","row0"],6],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["let","c0",["ext.data_model.seq_get","rv","row0",0]],["let","c1",["ext.data_model.seq_get","rv","row0",1]],["let","c2",["ext.data_model.seq_get","rv","row0",2]],["let","c3",["ext.data_model.seq_get","rv","row0",3]],["let","c4",["ext.data_model.seq_get","rv","row0",4]],["let","c5",["ext.data_model.seq_get","rv","row0",5]],["if",["if",["<","c0",0],1,["!=",["ext.data_model.kind_at","rv","c0"],2]],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["if",["if",["<","c1",0],1,["!=",["ext.data_model.kind_at","rv","c1"],3]],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["if",["if",["<","c2",0],1,["!=",["ext.data_model.kind_at","rv","c2"],3]],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["if",["if",["<","c3",0],1,["!=",["ext.data_model.kind_at","rv","c3"],3]],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["if",["if",["<","c4",0],1,["!=",["ext.data_model.kind_at","rv","c4"],2]],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["if",["if",["<","c5",0],1,["!=",["ext.data_model.kind_at","rv","c5"],2]],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["let","status_s",["ext.data_model.number_get","rv","c0"]],["let","st",["std.parse.i32_status_le",["bytes.view","status_s"]]],["if",["if",[">=u",["std.bytes.len","st"],5],["=",["bytes.get_u8","st",0],1],0],0,["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],["let","status_code",["codec.read_u32_le","st",1]],["let","status_msg",["ext.data_model.string_get","rv","c1"]],["let","created_at_b",["ext.data_model.string_get","rv","c2"]],["let","last_at_b",["ext.data_model.string_get","rv","c3"]],["let","ttl_s",["ext.data_model.number_get","rv","c4"]],["let","ttl_st",["std.parse.i32_status_le",["bytes.view","ttl_s"]]],["let","ttl_ms",["if",["if",[">=u",["std.bytes.len","ttl_st"],5],["=",["bytes.get_u8","ttl_st",0],1],0],["codec.read_u32_le","ttl_st",1],0]],["let","poll_s",["ext.data_model.number_get","rv","c5"]],["let","poll_st",["std.parse.i32_status_le",["bytes.view","poll_s"]]],["let","poll_ms",["if",["if",[">=u",["std.bytes.len","poll_st"],5],["=",["bytes.get_u8","poll_st",0],1],0],["codec.read_u32_le","poll_st",1],0]],["result_bytes.ok",["std.mcp.sandbox.task_store_sqlite_v1._task_val_v1","task_id","status_code",["bytes.view","status_msg"],["bytes.view","created_at_b"],["bytes.view","last_at_b"],"ttl_ms","poll_ms"]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.get_task_value_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1","store"],1],0,["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],["let","lim2",["if",["<","limit",1],50,"limit"]],["let","offset0",0],["if",[">",["view.len","cursor_b64"],0],["begin",["let","off_res",["std.mcp.sandbox.task_store_sqlite_v1.cursor_decode_v1","auth_context_id","cursor_b64"]],["if",["!=",["result_i32.err_code","off_res"],0],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_invalid_cursor_v1"]]],0],["set","offset0",["result_i32.unwrap_or","off_res",0]],0],0],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1","store"]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",["result_bytes.err",["result_i32.err_code","conn_res"]]],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","_gc",["std.mcp.sandbox.task_store_sqlite_v1._gc_v1","conn","auth_context_id"]],["let","sql",["bytes.lit","SELECT task_id, status_code, status_message, created_at, last_updated_at, ttl_ms, poll_ms FROM mcp_tasks WHERE auth_context_id = ?1 ORDER BY created_unix_s DESC LIMIT ?2 OFFSET ?3;"]],["let","p1",["ext.data_model.value_string","auth_context_id"]],["let","_x07_tmp_borrow_decls_30_body_12_2_1",["std.fmt.s32_to_dec","lim2"]],["let","p2",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_30_body_12_2_1"]]],["let","_x07_tmp_borrow_decls_30_body_13_2_1",["std.fmt.s32_to_dec","offset0"]],["let","p3",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_30_body_13_2_1"]]],["let","elems",["vec_u8.with_capacity",128]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",3]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p2"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","p3"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","p3"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","doc_res",["std.mcp.sandbox.task_store_sqlite_v1._query_doc_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["if",["!=",["result_bytes.err_code","doc_res"],0],["return","doc_res"],0],["let","rows_doc",["result_bytes.unwrap_or","doc_res",["bytes.alloc",0]]],["let","rows_val",["std.db.dm.rows_doc_rows_value_v1",["bytes.view","rows_doc"]]],["let","rv",["bytes.view","rows_val"]],["if",["=",["std.bytes.len","rv"],0],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["if",["!=",["ext.data_model.kind_at","rv",0],4],["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]],0],["let","rows_off",0],["let","n",["ext.data_model.seq_len","rv","rows_off"]],["let","taken",["if",["<","n",0],0,"n"]],["let","elems2",["vec_u8.with_capacity",1024]],["set","elems2",["vec_u8.extend_bytes","elems2",["codec.write_u32_le","taken"]]],["for","i",0,"taken",["begin",["let","row",["ext.data_model.seq_get","rv","rows_off","i"]],["if",["<","row",0],0,["begin",["if",["!=",["ext.data_model.kind_at","rv","row"],4],0,["begin",["if",["<",["ext.data_model.seq_len","rv","row"],7],0,["begin",["let","c_task",["ext.data_model.seq_get","rv","row",0]],["let","c_status",["ext.data_model.seq_get","rv","row",1]],["let","c_msg",["ext.data_model.seq_get","rv","row",2]],["let","c_created",["ext.data_model.seq_get","rv","row",3]],["let","c_last",["ext.data_model.seq_get","rv","row",4]],["let","c_ttl",["ext.data_model.seq_get","rv","row",5]],["let","c_poll",["ext.data_model.seq_get","rv","row",6]],["if",["if",["<","c_task",0],1,["!=",["ext.data_model.kind_at","rv","c_task"],3]],0,["begin",["let","task_id_b",["ext.data_model.string_get","rv","c_task"]],["let","status_code",["begin",["if",["if",["<","c_status",0],1,["!=",["ext.data_model.kind_at","rv","c_status"],2]],["-",0,1],["begin",["let","ns",["ext.data_model.number_get","rv","c_status"]],["let","st",["std.parse.i32_status_le",["bytes.view","ns"]]],["if",["if",[">=u",["std.bytes.len","st"],5],["=",["bytes.get_u8","st",0],1],0],["codec.read_u32_le","st",1],["-",0,1]]]]]],["let","msg_b",["if",["if",["<","c_msg",0],1,["!=",["ext.data_model.kind_at","rv","c_msg"],3]],["bytes.alloc",0],["ext.data_model.string_get","rv","c_msg"]]],["let","created_b",["if",["if",["<","c_created",0],1,["!=",["ext.data_model.kind_at","rv","c_created"],3]],["bytes.alloc",0],["ext.data_model.string_get","rv","c_created"]]],["let","last_b",["if",["if",["<","c_last",0],1,["!=",["ext.data_model.kind_at","rv","c_last"],3]],["bytes.alloc",0],["ext.data_model.string_get","rv","c_last"]]],["let","ttl_ms2",["begin",["if",["if",["<","c_ttl",0],1,["!=",["ext.data_model.kind_at","rv","c_ttl"],2]],0,["begin",["let","ns2",["ext.data_model.number_get","rv","c_ttl"]],["let","st2",["std.parse.i32_status_le",["bytes.view","ns2"]]],["if",["if",[">=u",["std.bytes.len","st2"],5],["=",["bytes.get_u8","st2",0],1],0],["codec.read_u32_le","st2",1],0]]]]],["let","poll_ms2",["begin",["if",["if",["<","c_poll",0],1,["!=",["ext.data_model.kind_at","rv","c_poll"],2]],0,["begin",["let","ns3",["ext.data_model.number_get","rv","c_poll"]],["let","st3",["std.parse.i32_status_le",["bytes.view","ns3"]]],["if",["if",[">=u",["std.bytes.len","st3"],5],["=",["bytes.get_u8","st3",0],1],0],["codec.read_u32_le","st3",1],0]]]]],["let","task_val",["std.mcp.sandbox.task_store_sqlite_v1._task_val_v1",["bytes.view","task_id_b"],"status_code",["bytes.view","msg_b"],["bytes.view","created_b"],["bytes.view","last_b"],"ttl_ms2","poll_ms2"]],["set","elems2",["vec_u8.extend_bytes","elems2",["codec.write_u32_le",["std.bytes.len","task_val"]]]],["set","elems2",["vec_u8.extend_bytes","elems2",["bytes.view","task_val"]]],0]]]]]]]],0]],["let","elems2_b",["vec_u8.into_bytes","elems2"]],["let","tasks_seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","elems2_b"]]],["let","k_tasks",["bytes.lit","tasks"]],["let","k_next",["bytes.lit","nextCursor"]],["let","v_tasks","tasks_seq_val"],["let","v_next",["ext.data_model.value_null"]],["let","next_offset",["+","offset0","taken"]],["if",["<","taken","lim2"],0,["begin",["let","cur",["std.mcp.sandbox.task_store_sqlite_v1.cursor_encode_v1","auth_context_id","next_offset"]],["set","v_next",["ext.data_model.value_string",["bytes.view","cur"]]],0]],["let","entries",["vec_u8.with_capacity",256]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",2]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_next"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_next"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_next"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_next"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","k_tasks"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","k_tasks"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["std.bytes.len","v_tasks"]]]],["set","entries",["vec_u8.extend_bytes","entries",["bytes.view","v_tasks"]]],["let","eb3",["vec_u8.into_bytes","entries"]],["let","val",["ext.data_model.value_map_from_entries",["bytes.view","eb3"]]],["let","json",["std.mcp.util.json.json_from_value_v1",["bytes.view","val"]]],["result_bytes.ok","json"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.list_tasks_json_v1","params":[{"name":"store","ty":"bytes_view"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"cursor_b64","ty":"bytes_view"},{"name":"limit","ty":"i32"}],"result":"result_bytes"},{"body":["begin",["let","max2",["if",["<","max_tasks",1],1,"max_tasks"]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1","db_path"]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",["result_bytes.err",["result_i32.err_code","conn_res"]]],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","ddl",["bytes.lit","CREATE TABLE IF NOT EXISTS mcp_tasks (auth_context_id TEXT NOT NULL, task_id TEXT NOT NULL, status_code INTEGER NOT NULL, status_message TEXT NOT NULL, created_at TEXT NOT NULL, last_updated_at TEXT NOT NULL, created_unix_s INTEGER NOT NULL, last_unix_s INTEGER NOT NULL, ttl_ms INTEGER NOT NULL, poll_ms INTEGER NOT NULL, request_id_json TEXT NOT NULL, progress_token_json TEXT NOT NULL, tool_name TEXT NOT NULL, args_json TEXT NOT NULL, ticks_done INTEGER NOT NULL, result_json TEXT NOT NULL, PRIMARY KEY(auth_context_id, task_id));"]],["let","_ddl",["std.mcp.sandbox.task_store_sqlite_v1._exec0_v1","conn","ddl"]],["let","idx",["bytes.lit","CREATE INDEX IF NOT EXISTS idx_mcp_tasks_created ON mcp_tasks(auth_context_id, created_unix_s DESC);"]],["let","_idx",["std.mcp.sandbox.task_store_sqlite_v1._exec0_v1","conn","idx"]],["let","now_iso",["ext.time.os.now_rfc3339_utc_v1"]],["let","now_unix",["std.mcp.sandbox.task_store_sqlite_v1._unix_s_or_0_v1",["bytes.view","now_iso"]]],["let","msg",["bytes.lit","server restarted"]],["let","sql",["bytes.lit","UPDATE mcp_tasks SET status_code = 3, status_message = ?1, last_updated_at = ?2, last_unix_s = ?3, result_json = '' WHERE status_code = 0 OR status_code = 1;"]],["let","v1",["ext.data_model.value_string",["bytes.view","msg"]]],["let","v2",["ext.data_model.value_string",["bytes.view","now_iso"]]],["let","_x07_tmp_borrow_decls_31_body_15_2_1",["std.fmt.s32_to_dec","now_unix"]],["let","v3",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_31_body_15_2_1"]]],["let","elems",["vec_u8.with_capacity",128]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",3]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v2"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v3"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v3"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","_up",["std.mcp.sandbox.task_store_sqlite_v1._exec_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["let","path_b",["view.to_bytes","db_path"]],["let","path_len",["bytes.len",["bytes.view","path_b"]]],["let","out",["vec_u8.with_capacity",["+",12,"path_len"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","max2"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","path_len"]]],["if",[">","path_len",0],["begin",["set","out",["vec_u8.extend_bytes","out",["bytes.view","path_b"]]],0],0],["result_bytes.ok",["vec_u8.into_bytes","out"]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.new_v1","params":[{"name":"db_path","ty":"bytes_view"},{"name":"max_tasks","ty":"i32"}],"result":"result_bytes"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1",["bytes.view","store"]],1],0,["return","store"]],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1",["bytes.view","store"]]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return","store"],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","created_unix",["std.mcp.sandbox.task_store_sqlite_v1._unix_s_or_0_v1","created_at"]],["let","last_unix",["std.mcp.sandbox.task_store_sqlite_v1._unix_s_or_0_v1","last_updated_at"]],["let","sql",["bytes.lit","INSERT OR REPLACE INTO mcp_tasks (auth_context_id, task_id, status_code, status_message, created_at, last_updated_at, created_unix_s, last_unix_s, ttl_ms, poll_ms, request_id_json, progress_token_json, tool_name, args_json, ticks_done, result_json) VALUES (?1,?2,0,'queued',?3,?4,?5,?6,?7,?8,?9,?10,?11,?12,0,'');"]],["let","v1",["ext.data_model.value_string","auth_context_id"]],["let","v2",["ext.data_model.value_string","task_id"]],["let","v3",["ext.data_model.value_string","created_at"]],["let","v4",["ext.data_model.value_string","last_updated_at"]],["let","_x07_tmp_borrow_decls_32_body_13_2_1",["std.fmt.s32_to_dec","created_unix"]],["let","v5",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_32_body_13_2_1"]]],["let","_x07_tmp_borrow_decls_32_body_14_2_1",["std.fmt.s32_to_dec","last_unix"]],["let","v6",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_32_body_14_2_1"]]],["let","_x07_tmp_borrow_decls_32_body_15_2_1",["std.fmt.s32_to_dec","ttl_ms"]],["let","v7",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_32_body_15_2_1"]]],["let","_x07_tmp_borrow_decls_32_body_16_2_1",["std.fmt.s32_to_dec","poll_ms"]],["let","v8",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_32_body_16_2_1"]]],["let","v9",["ext.data_model.value_string","request_id_json"]],["let","v10",["ext.data_model.value_string","progress_token_json"]],["let","v11",["ext.data_model.value_string","tool_name"]],["let","v12",["ext.data_model.value_string","args_json"]],["let","elems",["vec_u8.with_capacity",512]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",12]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v2"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v3"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v3"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v4"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v4"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v5"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v5"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v6"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v6"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v7"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v7"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v8"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v8"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v9"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v9"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v10"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v10"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v11"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v11"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v12"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v12"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","_",["std.mcp.sandbox.task_store_sqlite_v1._exec_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],"store"],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.put_tool_task_new_v1","params":[{"name":"store","ty":"bytes"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"created_at","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"ttl_ms","ty":"i32"},{"name":"poll_ms","ty":"i32"},{"name":"request_id_json","ty":"bytes_view"},{"name":"progress_token_json","ty":"bytes_view"},{"name":"tool_name","ty":"bytes_view"},{"name":"args_json","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","empty",["bytes.alloc",0]],["std.mcp.sandbox.task_store_sqlite_v1._set_terminal_v1","store","auth_context_id","task_id","last_updated_at",4,["bytes.view","empty"],"cancel_err_json"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.set_task_cancelled_v1","params":[{"name":"store","ty":"bytes"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"cancel_err_json","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["let","empty",["bytes.alloc",0]],["let","done_utf8",["bytes.lit","done"]],["std.mcp.sandbox.task_store_sqlite_v1._set_terminal_v1","store","auth_context_id","task_id","last_updated_at",2,["bytes.view","done_utf8"],"result_json"]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.set_task_completed_v1","params":[{"name":"store","ty":"bytes"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"result_json","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["let","empty",["bytes.alloc",0]],["std.mcp.sandbox.task_store_sqlite_v1._set_terminal_v1","store","auth_context_id","task_id","last_updated_at",3,"status_message",["bytes.view","empty"]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.set_task_failed_v1","params":[{"name":"store","ty":"bytes"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"status_message","ty":"bytes_view"}],"result":"result_bytes"},{"body":["std.mcp.sandbox.task_store_sqlite_v1._set_terminal_v1","store","auth_context_id","task_id","last_updated_at",3,"status_message","result_json"],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.set_task_failed_with_result_v1","params":[{"name":"store","ty":"bytes"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"status_message","ty":"bytes_view"},{"name":"result_json","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1",["bytes.view","store"]],1],0,["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1",["bytes.view","store"]]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",["result_bytes.err",["result_i32.err_code","conn_res"]]],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","last_unix",["std.mcp.sandbox.task_store_sqlite_v1._unix_s_or_0_v1","last_updated_at"]],["let","sql",["bytes.lit","UPDATE mcp_tasks SET status_code = 0, status_message = ?1, last_updated_at = ?2, last_unix_s = ?3, ticks_done = ticks_done + 1 WHERE auth_context_id = ?4 AND task_id = ?5 AND (status_code = 0 OR status_code = 1);"]],["let","v1",["ext.data_model.value_string","status_message_utf8"]],["let","v2",["ext.data_model.value_string","last_updated_at"]],["let","_x07_tmp_last_unix_dec",["std.fmt.s32_to_dec","last_unix"]],["let","v3",["ext.data_model.value_number",["bytes.view","_x07_tmp_last_unix_dec"]]],["let","v4",["ext.data_model.value_string","auth_context_id"]],["let","v5",["ext.data_model.value_string","task_id"]],["let","elems",["vec_u8.with_capacity",192]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",5]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v2"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v3"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v3"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v4"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v4"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v5"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v5"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","res",["std.mcp.sandbox.task_store_sqlite_v1._exec_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["if",["=",["result_i32.err_code","res"],0],["result_bytes.ok","store"],["result_bytes.err",["result_i32.err_code","res"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.set_task_status_message_v1","params":[{"name":"store","ty":"bytes"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"status_message_utf8","ty":"bytes_view"}],"result":"result_bytes"},{"body":["begin",["if",["=",["std.mcp.sandbox.task_store_sqlite_v1._store_ok_v1",["bytes.view","store"]],1],0,["return",["result_bytes.err",["std.mcp.sandbox.task_store_sqlite_v1._err_db_v1"]]]],["let","db_path",["std.mcp.sandbox.task_store_sqlite_v1._store_path_v1",["bytes.view","store"]]],["let","conn_res",["std.mcp.sandbox.task_store_sqlite_v1._conn_open_v1",["bytes.view","db_path"]]],["if",["!=",["result_i32.err_code","conn_res"],0],["return",["result_bytes.err",["result_i32.err_code","conn_res"]]],0],["let","conn",["result_i32.unwrap_or","conn_res",-1]],["let","k1",["std.fmt.s32_to_dec",["if",["<","step",1],1,"step"]]],["let","k2",["std.fmt.s32_to_dec",["if",["<","total",1],1,"total"]]],["let","pfx",["bytes.lit","step "]],["let","mid",["bytes.lit","/"]],["let","t1",["std.bytes.concat",["bytes.view","pfx"],["bytes.view","k1"]]],["let","t2",["std.bytes.concat",["bytes.view","t1"],["bytes.view","mid"]]],["let","msg",["std.bytes.concat",["bytes.view","t2"],["bytes.view","k2"]]],["let","last_unix",["std.mcp.sandbox.task_store_sqlite_v1._unix_s_or_0_v1","last_updated_at"]],["let","sql",["bytes.lit","UPDATE mcp_tasks SET status_code = 0, status_message = ?1, last_updated_at = ?2, last_unix_s = ?3, ticks_done = ticks_done + 1 WHERE auth_context_id = ?4 AND task_id = ?5 AND (status_code = 0 OR status_code = 1);"]],["let","v1",["ext.data_model.value_string",["bytes.view","msg"]]],["let","v2",["ext.data_model.value_string","last_updated_at"]],["let","_x07_tmp_borrow_decls_37_body_17_2_1",["std.fmt.s32_to_dec","last_unix"]],["let","v3",["ext.data_model.value_number",["bytes.view","_x07_tmp_borrow_decls_37_body_17_2_1"]]],["let","v4",["ext.data_model.value_string","auth_context_id"]],["let","v5",["ext.data_model.value_string","task_id"]],["let","elems",["vec_u8.with_capacity",192]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",5]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v1"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v1"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v2"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v2"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v3"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v3"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v4"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v4"]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",["std.bytes.len","v5"]]]],["set","elems",["vec_u8.extend_bytes","elems",["bytes.view","v5"]]],["let","eb",["vec_u8.into_bytes","elems"]],["let","seq_val",["ext.data_model.value_seq_from_elems",["bytes.view","eb"]]],["let","params_doc",["ext.data_model.doc_ok",["bytes.view","seq_val"]]],["let","res",["std.mcp.sandbox.task_store_sqlite_v1._exec_v1","conn","sql","params_doc"]],["let","_close",["std.mcp.sandbox.task_store_sqlite_v1._conn_close_v1","conn"]],["if",["=",["result_i32.err_code","res"],0],["result_bytes.ok","store"],["result_bytes.err",["result_i32.err_code","res"]]]],"kind":"defn","name":"std.mcp.sandbox.task_store_sqlite_v1.set_task_working_step_v1","params":[{"name":"store","ty":"bytes"},{"name":"auth_context_id","ty":"bytes_view"},{"name":"task_id","ty":"bytes_view"},{"name":"last_updated_at","ty":"bytes_view"},{"name":"step","ty":"i32"},{"name":"total","ty":"i32"}],"result":"result_bytes"}],"imports":["ext.base64","ext.data_model","ext.time.os","ext.time.rfc3339","std.bytes","std.codec","std.db.dm","std.db.params","std.db.spec","std.db.sqlite","std.db.sqlite.spec","std.fmt","std.mcp.util.json","std.parse"],"kind":"module","module_id":"std.mcp.sandbox.task_store_sqlite_v1","schema_version":"x07.x07ast@0.5.0"}

{"decls":[{"kind":"export","names":["std.mcp.obs.metrics.counter_inc_v1","std.mcp.obs.metrics.hist_observe_ms_v1"]},{"body":["begin",["let","num_s",["std.fmt.s32_to_dec","value"]],["let","out",["vec_u8.with_capacity",256]],["set","out",["vec_u8.extend_bytes","out",["bytes.view",["bytes.lit","{\"kind\":\""]]]],["set","out",["vec_u8.extend_bytes","out","kind_text"]],["set","out",["vec_u8.extend_bytes","out",["bytes.view",["bytes.lit","\",\"name\":\""]]]],["set","out",["vec_u8.extend_bytes","out","metric_name"]],["set","out",["vec_u8.extend_bytes","out",["bytes.view",["bytes.lit","\",\"label\":{"]]]],["if",[">",["view.len","label_key"],0],["begin",["set","out",["vec_u8.extend_bytes","out",["bytes.view",["bytes.lit","\""]]]],["set","out",["vec_u8.extend_bytes","out","label_key"]],["set","out",["vec_u8.extend_bytes","out",["bytes.view",["bytes.lit","\":\""]]]],["set","out",["vec_u8.extend_bytes","out","label_value"]],["set","out",["vec_u8.extend_bytes","out",["bytes.view",["bytes.lit","\""]]]],0],0],["set","out",["vec_u8.extend_bytes","out",["bytes.view",["bytes.lit","},\"value\":"]]]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","num_s"]]],["set","out",["vec_u8.extend_bytes","out",["bytes.view",["bytes.lit","}"]]]],["std.mcp.obs.audit.emit_jsonl_v1",["bytes.view",["bytes.lit","stderr_jsonl"]],["bytes.view",["vec_u8.into_bytes","out"]]]],"kind":"defn","name":"std.mcp.obs.metrics._emit_metric_v1","params":[{"name":"kind_text","ty":"bytes_view"},{"name":"metric_name","ty":"bytes_view"},{"name":"label_key","ty":"bytes_view"},{"name":"label_value","ty":"bytes_view"},{"name":"value","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["!=","enabled",1],["return",0],0],["std.mcp.obs.metrics._emit_metric_v1",["bytes.view",["bytes.lit","counter"]],"metric_name","label_key","label_value","delta"]],"kind":"defn","name":"std.mcp.obs.metrics.counter_inc_v1","params":[{"name":"enabled","ty":"i32"},{"name":"metric_name","ty":"bytes_view"},{"name":"label_key","ty":"bytes_view"},{"name":"label_value","ty":"bytes_view"},{"name":"delta","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["!=","enabled",1],["return",0],0],["std.mcp.obs.metrics._emit_metric_v1",["bytes.view",["bytes.lit","hist_ms"]],"metric_name","label_key","label_value","value_ms"]],"kind":"defn","name":"std.mcp.obs.metrics.hist_observe_ms_v1","params":[{"name":"enabled","ty":"i32"},{"name":"metric_name","ty":"bytes_view"},{"name":"label_key","ty":"bytes_view"},{"name":"label_value","ty":"bytes_view"},{"name":"value_ms","ty":"i32"}],"result":"i32"}],"imports":["std.fmt","std.mcp.obs.audit"],"kind":"module","module_id":"std.mcp.obs.metrics","schema_version":"x07.x07ast@0.5.0"}
